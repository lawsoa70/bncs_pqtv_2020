  <HTML>
    <HEAD>
      <TITLE>Colledia Control Classes</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<center>
    <img src="../../images/dev_menu_head.png" >
</center>

<!-- Generated by Doxygen 1.4.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>CsnmpBncs Class Reference</h1><!-- doxytag: class=<CsnmpBncs> -->This provides an interface to SNMP managed devices.  
<a href="#_details">More...</a>
<p>
<a href="class_csnmp_bncs-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a0">GetRetransMode</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a1">setRetransMode</a> (int iMode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a2">getTimeout</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a3">setTimeout</a> (int iTime)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a4">setRetry</a> (int iRetry)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a5">getRetry</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a6">CsnmpBncs</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a7">~CsnmpBncs</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a8">init_snmp</a> (LPSTR szIpAdd, LPSTR szCommunity)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a9">close_snmp</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a10">SendSnmpMessage</a> (int iOperation, char szOID[], LPSTR szData, int iDataType, UINT uMssgeNum)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a11">GetValue</a> (HSNMP_VBL vbl, int iEntry, int iSize, LPSTR lpString)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a12">GetOid</a> (HSNMP_VBL vbl, int iEntry, int iSize, LPSTR lpString)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a13">CmpOid</a> (HSNMP_VBL vbl, int iEntry, LPSTR lpString, LPINT result)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a14">CmpValueOid</a> (HSNMP_VBL vbl, int iEntry, LPSTR lpString, LPINT result)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">SNMPAPI_STATUS CALLBACK&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_csnmp_bncs.html#a15">instance_callback</a> (HSNMP_SESSION, HWND, UINT, WPARAM, LPARAM)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This provides an interface to SNMP managed devices. 
<p>
CsnmpBncs provides an interface to SNMP managed devices<p>
CsnmpBncs provides an interface to SNMP managed devices, including the memory managment of the associated resources. Each instance of the class can only talk to a single managed device, so if you need to talk to more devices create further instances of this class.<p>
As the windows implementation of SNMP will send messages in it's own time there are certain threading that need to be noted, these will be detailed at the relevant point in the code, but do remember to compile your application as a multithreaded application (Project|Settings|C/C++|Code generation).<p>
Please note that this is built on top of the Windows SNMP implementation (WINSnmp), so there may be some things that are set by Microsoft.
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a6"></a><!-- doxytag: member=<CsnmpBncs::CsnmpBncs> ref=<a6> args=<(void)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">CsnmpBncs::CsnmpBncs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a6">CsnmpBncs::CsnmpBncs()</a> initialises an instance of the CsnmpBncs class. <dl compact><dt><b>Returns:</b></dt><dd></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a7"></a><!-- doxytag: member=<CsnmpBncs::~CsnmpBncs> ref=<a7> args=<(void)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">CsnmpBncs::~CsnmpBncs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a7">CsnmpBncs::~CsnmpBncs(void)</a> cleans up after the class. <a class="el" href="class_csnmp_bncs.html#a9">CsnmpBncs::close_snmp(void)</a> should be called first! <dl compact><dt><b>Returns:</b></dt><dd></dd></dl>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a9"></a><!-- doxytag: member=<CsnmpBncs::close_snmp> ref=<a9> args=<(void)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::close_snmp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a9">CsnmpBncs::close_snmp(void)</a> closes the connection to the SNMP device and un-registers from Trap messages. <dl compact><dt><b>Returns:</b></dt><dd>int 0 if OK, otherwise 1</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a13"></a><!-- doxytag: member=<CsnmpBncs::CmpOid> ref=<a13> args=<(HSNMP_VBL vbl, int iEntry, LPSTR lpString, LPINT result)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::CmpOid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSNMP_VBL&nbsp;</td>
          <td class="mdname" nowrap> <em>vbl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>result</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a13">CsnmpBncs::CmpOid(HSNMP_VBL vbl, int iEntry, LPSTR lpString, LPINT result)</a> Compares the OID supplied with entry iEntry's OID <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>vbl</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iEntry</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lpString</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>result</em>&nbsp;</td><td>0=match </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0=OK ,1=Fail</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a14"></a><!-- doxytag: member=<CsnmpBncs::CmpValueOid> ref=<a14> args=<(HSNMP_VBL vbl, int iEntry, LPSTR lpString, LPINT result)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::CmpValueOid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSNMP_VBL&nbsp;</td>
          <td class="mdname" nowrap> <em>vbl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>result</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a14">CsnmpBncs::CmpValueOid(HSNMP_VBL vbl, int iEntry, LPSTR lpString, LPINT result)</a> compares the OID that is returned as a value in VBL with the supplied string <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>vbl</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iEntry</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lpString</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>result</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0=OK ,1=Fail</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a12"></a><!-- doxytag: member=<CsnmpBncs::GetOid> ref=<a12> args=<(HSNMP_VBL vbl, int iEntry, int iSize, LPSTR lpString)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::GetOid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSNMP_VBL&nbsp;</td>
          <td class="mdname" nowrap> <em>vbl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpString</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a12">CsnmpBncs::GetOid(HSNMP_VBL vbl, int iEntry, int iSize, LPSTR lpString)</a> Gets the value of entry iEntry from variable binding list (VBL) and converts it to text <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>vbl</em>&nbsp;</td><td>Pointer to the VBL </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iEntry</em>&nbsp;</td><td>Entry in the list to get </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iSize</em>&nbsp;</td><td>Size of string </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lpString</em>&nbsp;</td><td>Storage to put string in </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0=OK ,1=Fail</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a0"></a><!-- doxytag: member=<CsnmpBncs::GetRetransMode> ref=<a0> args=<()> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::GetRetransMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a0">CsnmpBncs::GetRetransMode()</a> gets the current retransmit mode, this is either SNMPAPI_ON, SNMPAPI_OFF or -1 for failure <dl compact><dt><b>Returns:</b></dt><dd>int </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_csnmp_bncs.html#a1">setRetransMode()</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a5"></a><!-- doxytag: member=<CsnmpBncs::getRetry> ref=<a5> args=<()> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::getRetry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function CsnmpBncs::getLastRetry() returns the number of retries set in the retry policy, -1 if this is not avaialble.<p>
<dl compact><dt><b>Returns:</b></dt><dd>int </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_csnmp_bncs.html#a4">setRetry()</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a2"></a><!-- doxytag: member=<CsnmpBncs::getTimeout> ref=<a2> args=<()> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::getTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a2">CsnmpBncs::getTimeout()</a> gets the current timeout period, in hundredths of a second, if it fails -1 is returned. <dl compact><dt><b>Returns:</b></dt><dd>int </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_csnmp_bncs.html#a3">setTimeout()</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a11"></a><!-- doxytag: member=<CsnmpBncs::GetValue> ref=<a11> args=<(HSNMP_VBL vbl, int iEntry, int iSize, LPSTR lpString)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::GetValue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSNMP_VBL&nbsp;</td>
          <td class="mdname" nowrap> <em>vbl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpString</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a11">CsnmpBncs::GetValue(HSNMP_VBL vbl, int iEntry, int iSize, LPSTR lpString)</a> Gets the value of entry iEntry from variable binding list (VBL) and converts it to text <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>vbl</em>&nbsp;</td><td>Pointer to the VBL </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iEntry</em>&nbsp;</td><td>Entry in the list to get </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iSize</em>&nbsp;</td><td>Size of string </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lpString</em>&nbsp;</td><td>Storage to put string in </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0=OK ,1=Fail</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a8"></a><!-- doxytag: member=<CsnmpBncs::init_snmp> ref=<a8> args=<(LPSTR szIpAdd, LPSTR szCommunity)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::init_snmp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szIpAdd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szCommunity</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a8">CsnmpBncs::init_snmp(LPSTR szIpAdd,LPSTR szCommunity)</a> sets up the connection to the SNMP device and registers for incoming Trap messages. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>szIpAdd</em>&nbsp;</td><td>= IP address of the unit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>szCommunity</em>&nbsp;</td><td>= community name </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0 if OK, otherwise 1</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a15"></a><!-- doxytag: member=<CsnmpBncs::instance_callback> ref=<a15> args=<(HSNMP_SESSION, HWND, UINT, WPARAM, LPARAM)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">SNMPAPI_STATUS CALLBACK CsnmpBncs::instance_callback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HSNMP_SESSION&nbsp;</td>
          <td class="mdname" nowrap> <em>hSession</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wMsg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>WPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is an internal function, DO NOT USE!!!!    </td>
  </tr>
</table>
<a class="anchor" name="a10"></a><!-- doxytag: member=<CsnmpBncs::SendSnmpMessage> ref=<a10> args=<(int iOperation, char szOID[], LPSTR szData, int iDataType, UINT uMssgeNum)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::SendSnmpMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>iOperation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char&nbsp;</td>
          <td class="mdname" nowrap> <em>szOID</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iDataType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uMssgeNum</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a10">CsnmpBncs::SendSnmpMessage</a>(int iOperation, char szOID[], LPSTR szData, int iDataType, UINT uMssgeNum) sends a message to the SNMP device, this does not wait for a reply, but returns the sending application straight away.<p>
WinSnmp has it's own retransmittion policy, this can be disabled by calling SnmpSetRetransmitMode(SNMPAPI_OFF); <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iOperation</em>&nbsp;</td><td><ul>
<li>SNMP_PDU_GET</li><li>SNMP_PDU_GETNEXT</li><li>SNMP_PDU_SET </li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>szOID[]</em>&nbsp;</td><td>OID of the object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>szData</em>&nbsp;</td><td>Pointer to the data to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iDataType</em>&nbsp;</td><td>Data type to send<ul>
<li>SNMP_SYNTAX_OCTETS</li><li>SNMP_SYNTAX_BITS</li><li>SNMP_SYNTAX_OPAQUE</li><li>SNMP_SYNTAX_IPADDR</li><li>SNMP_SYNTAX_NSAPADDR</li><li>SNMP_SYNTAX_INT</li><li>SNMP_SYNTAX_UINT32</li><li>SNMP_SYNTAX_CNTR32</li><li>SNMP_SYNTAX_GAUGE32</li><li>SNMP_SYNTAX_TIMETICKS</li><li>SNMP_SYNTAX_OID</li><li>SNMP_SYNTAX_NULL</li><li>SNMP_SYNTAX_NOSUCHOBJECT</li><li>SNMP_SYNTAX_NOSUCHINSTANCE</li><li>SNMP_SYNTAX_ENDOFMIBVIEW </li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uMssgeNum</em>&nbsp;</td><td>User message number </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0 if OK, otherwise 1</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a1"></a><!-- doxytag: member=<CsnmpBncs::setRetransMode> ref=<a1> args=<(int iMode)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::setRetransMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>iMode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a1">CsnmpBncs::setRetransMode(int iMode)</a> sets the SNMP retransmission mode to iMode, this is either SNMPAPI_ON or SNMPAPI_OFF.<p>
If you set the retransmission mode to off you will NOT get timeout notifications. With retransmissions on after the timeout period it will resend up to the number of times set by <a class="el" href="class_csnmp_bncs.html#a4">setRetry()</a>, if there is still no reply you will get an error message. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iMode</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0=success </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd>getRetransMode()</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a4"></a><!-- doxytag: member=<CsnmpBncs::setRetry> ref=<a4> args=<(int iRetry)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::setRetry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>iRetry</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a4">CsnmpBncs::setRetry(int iRetry)</a> sets the number of times WinSnmp will try and send to the device. 's own retransmittion policy can be disabled by calling SnmpSetRetransmitMode(SNMPAPI_OFF);<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iRetry</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0=Succes</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_csnmp_bncs.html#a5">getRetry()</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a3"></a><!-- doxytag: member=<CsnmpBncs::setTimeout> ref=<a3> args=<(int iTime)> --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CsnmpBncs::setTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>iTime</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The function <a class="el" href="class_csnmp_bncs.html#a3">CsnmpBncs::setTimeout(int iTime)</a> sets the timeout to iTime hundredths of a second. If this parameter is equal to zero, and the current retransmission mode is equal to SNMPAPI_ON, the implementation selects a time-out value. The implementation uses this time-out value when it executes the WinSNMP application's retransmission policy. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iTime</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>int 0=success </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_csnmp_bncs.html#a2">getTimeout()</a>,<a class="el" href="class_csnmp_bncs.html#a0">GetRetransMode()</a></dd></dl>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cbncssnmp_8h-source.html">cbncssnmp.h</a><li>Cbncssnmp.cpp</ul>
    <hr>
    </BODY>
    <address>Generated by Colledia Control Build Machine on Wed Nov 22 08:21:17 2006</address>
  </HTML>

